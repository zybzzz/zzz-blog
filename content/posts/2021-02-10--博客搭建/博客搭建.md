---
title: 博客搭建--gatsby和react的全新体验
category: "博客修改搭建"
cover: 1.jpg
author: YiBo Zhang
---

在寻找vue博客项目的时候偶然发现了一个让人眼睛一亮的gatsby项目，抱着猎奇的心态开启了对gatsby这个框架的探索，在这个过程中也产生了对gatsby和react的全新体验...



##  博客搭建--gatsby和react的全新体验



搭建博客的想法源于上个学期，一直有在想学到的web技术应该怎样去应用，就想着放假找个vue的项目来练练手顺便能深入的学一波vue，加之平时在看书的时候会有记录点md的习惯，于是就想着去github上拉个博客项目改改吧。原先对于web项目的理解只是停留在写前端页面，写后台，然后再部署这样的过程，在这个过程中一定会有关于数据库读写的问题，想想都是相当复杂的。后来在github上看到了国外大佬写的博客项目，页面写的十分漂亮，同时使用了gatsby的框架。页面实在写的太酷了，真的让人无法拒绝，于是就抱着猎奇的心态去浅浅探索了一下gatsby框架，然后稍作修改改出了一个自己的博客。



###  第一步：什么是gatsby



什么是gatsby，博客项目是基于gatsby搭建的，于是就打开了[gatsby的官网](https://www.gatsbyjs.com/)。首先了了解到的就是gatsby是一个前端的框架，同时gatsby又是基于react搭建的网站快速生成器。gatsby集成了大量的插件用于网页的快速开发，同时gatsby生成的网站能够适配于多个客户端，由此看来gatsby是十分适合用来进行小型网站的开发的。

关于react，那就更加熟悉了，react是一个应用非常广的js库，react拥有组件化、灵活的特点，由于gatsby是基于react的，因此使用gatsby还需了解react相关的知识。



###  环境搭建：了解Node.js



类似于gatsby这类前端框架的本地运行都是需要依赖本地的Node.js环境的，因此需要了解什么是Node.js。

Node.js是一个基于Chrome的js运行时环境，它能够使js代码脱离浏览器而运行。Node.js还提供了npm的包管理。

在开始的时候天真的以为一台电脑上只需要一个Node.js版本就够了，但是实际上只安装一个版本的Node.js完全不够，不同的项目是基于不同的Node.js版本搭建起来的，因此使用和他们不同的Node.js版本会报出不同的错误，不仅 npm install 会报错，等你解决完 npm install 的问题，结果还run不起来...相当气人。

后来上网查到一个名为 nvm 的Node.js版本管理工具，它能够在一台电脑上安装多个不同版本的Node.js，同时在必要的时候可以切换使用。这样就可以在不同的前端项目之间切换 Node.js版本，使多个前端项目都能运行。

```bash
# 安装相应版本的Node.js
nvm install version
# 使用指定版本的Node.js
nvm use version
# 列出可用版本的Node.js
nvm list available
```



###  环境搭建：包的安装

选择好适合的Node.js环境之后需要进行需要包的安装，直接npm install即可。npm install 也会遇到很多问题。首先安装速度慢需要更换源的镜像，国内直接换成淘宝的源就行了。其次gatsby用到的插件安装很多都是从github上直接下载的，而下载的时候给出的地址好像有一部分会解析不掉，因此还要修改主机的host文件，增加相关域名的解析。

剩下一个最坑的问题，gatsby的一些插件在windows下会依赖于 c++ 或是 python的环境，只要主机上没有相关的环境，那么包的安装就会失败。gatsby官网给出了相应的解决办法，主要通过npm 或是 visual stduio去安装相应的工具。这真是一段艰辛的历程，本想在windows主机上开发，结果整了一天连个包都装不起来，电脑上还给整的乱七八糟，人直接给装的血压升高了。后来投入mac的怀抱，直接就安装成功了。



###  尝试运行：gatsby develop

运行的时候可能会出现一直转圈运行不了的问题，这个就是Node.js版本的问题导致的，这个问题的解决需要更改Node.js的版本，然后重新安装包。还有运行成功然后飚红报错的问题，这些就是包的版本问题，需要卸掉一些包，然后安装相应版本的包。遇到问题直接复制然后谷歌搜索，大量热心老哥帮忙解决问题。



###  项目的解析与更改

1. 解析从目录开始，gatsby的项目有几个确定的目录划分，每个目录下的文件各司其职，理解目录名的大概意思很有助于对整个项目的结构理解。
2. 利用全局搜索功能，选取在页面上出现的一些信息，利用开发工具的全局搜索功能搜索出它所在项目中的位置，这样也能加深对于项目的理解。
3. 理解ES6的语法与react的组件式开发，从页面中的index主页看起，index中往往使用了import的语法引入了大量写好的组件，index页面也由组件构成，可以找到组件所在的位置，然后分析组件的组成，再一步一步分析下去，整个项目的结构就会非常的明朗。
4. 相关的配置基本都会放到一些名为config的文件中，可以在这些文件中更改相关的参数。在使用gatsby插件的时候，插件也会有相关的配置，gatsby-config.js中就是存放着有关插件的配置信息。
5. 项目中使用到了很多ES6的特性，包括大量使用的箭头函数，简化了函数的书写。还有ES6对对象的解构也应用广泛，大量的组件在开始都会对传入的参数进行对象的解构，再将解构完的数据拿来使用或是向下传递。
6. react中使用了JSX，简单的说就是在js的代码中写XML，页面的XML都被写在相关js文件的render函数中，该函数中的XML会被渲染到页面上。同时react的数据修改好像并不会导致页面的重新渲染，react的页面重新渲染好像借助于状态(state)，只有当设定的状态值改变的时候，页面才会被重新渲染。
7. 基于gatsby搭建的个人博客是一个静态网页项目，他是没有后台的，那么页面上使用到的数据应该从哪里来呢？这些数据都来源于项目根目录的文件中。在该gatsby项目中，使用了Graphql这种面向api的查询语言，通过集成gatsby的插件，它能够查询来自项目根目录中的文件数据。Graphql查询语言不只是能够查询本地的数据，它一样可以查询来自各处的数据，包括数据库，但是这个查询语言好像在国内还没有大量的使用，建议配合Graphql官网和gatsby官网使用，不然看到查询语句真就一脸懵。
8. Markdown文件的解析，嘿嘿全靠了gatsby插件和Graphql，markdown文件的解析相对来说还是比较方便的。



### 项目的部署：购买域名以及静态网页托管

域名的购买可以从各个平台购买，挑选自己喜欢的域名就行了。由于项目是静态网站，单独给他购买一个服务器太浪费了，于是就选择了netlify平台对网页进行了托管。使用netlify平台进行的托管真的超级方便，它可以直接和github上的仓库挂钩，只要对要部署的网页进行部署命令的设置和打包目录的设置，在每次git push到远程仓库的时候，netlify平台就会帮助自动部署，几分钟后就能完成静态页面的重新打包部署。另外在部署的时候也需要制定Node.js的版本，不然会一直部署失败，说多了都是泪...



###  全新的感悟与体验

总而言之，这次gatsby和react带来的体验是极佳的，组件式的开发真的能让结构清晰很多，改起来都特别方便。同时，这次的项目修改也让我发现了静态网页这个宝藏，网站的搭建原来也能这么方便，原先一味的以为数据只能来源于数据库，事实发现，数据可以来自各种各样的地方。

更让人感慨的是，别人的代码写的是真的好，层次分的很清晰，命名也非常的规范，站在现在的我角度去看真是无可挑剔，希望以后自己的代码水平也能够向他们更进一步。



